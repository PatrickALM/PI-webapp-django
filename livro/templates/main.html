{% extends 'base.html' %}

{% load static %}

{% block 'conteudo' %}
<!-- <div class="container border-start border-end shadow-lg pt-3"> 
    <div class="row mt-2">
        <div class="card text-white bg-dark mb-3 shadow-lg" style="max-width: 18rem;">

            <div class="card-body">
                <h3 class="card-title">Livros</h3>
                <p class="card-text"><h5>61</h5></p>
            </div>
        </div>
    </div>
</div> -->
<br>
<div class="container-lg">
    
    <div class="row">
     
      <div class="col-lg-3 col-3">
        <div class="cards">
          <table class="card shadow-lg ps-4" style="min-height: 100%;">
            <tr>
              <td class="text-center pt-2" ><svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" fill="currentColor" class="bi bi-book" viewBox="0 0 16 16">
                <path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"/>
              </svg> </td>
              
              <td class="text-center pt-3 ps-5 align-bottom" style="min-height: 100%;"> <h1> {{ qnt_livros }} </h1><br>
                <h5>Livros</h5></td> 
            </tr>
          
          </table>
        </div>
      </div>

      <div class="col-lg-3 col-3  ">
        <div class="cards">
          <table class="card shadow-lg ps-4" style="min-height: 100%;">
            <tr>
              <td class="text-center pt-2" ><svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7Zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm-5.784 6A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216ZM4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z"/>
              </svg> </td>
              
              <td class="text-center pt-3 ps-4"> <h1>  {{qnt_usuarios}}</h1></br>
                <h5>Usuários</h5></td> 
            </tr>
          
          </table>
        </div>
      </div>

      
      <div class="col-lg-3 col-3  ">
        <div class="cards">
          <table class="card shadow-lg ps-4" style="min-height: 100%;">
            <tr>
              <td class="text-center pt-2" ><svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" fill="currentColor" class="bi bi-clock-history" viewBox="0 0 16 16">
                <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"/>
                <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"/>
                <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"/>
              </svg> </td>
              
              <td class="text-center pt-3 ps-4"> <h1> {{qnt_emps}} </h1></br>
                <h5>Empréstimos</h5></td> 
            </tr>
          
          </table>
        </div>
      </div>

      <div class="col-lg-3 col-3  ">
        <div class="card-alert">
          <a href="{% url 'emprestimos' '1' %}" class="text-dark" style="text-decoration: none;">
            <table class="card shadow-lg ps-4" style="min-height: 100%;">
              <tr>
                <td class="text-center  pt-2" ><svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" fill="currentColor" class="bi bi-exclamation-octagon-fill" viewBox="0 0 16 16">
                  <path d="M11.46.146A.5.5 0 0 0 11.107 0H4.893a.5.5 0 0 0-.353.146L.146 4.54A.5.5 0 0 0 0 4.893v6.214a.5.5 0 0 0 .146.353l4.394 4.394a.5.5 0 0 0 .353.146h6.214a.5.5 0 0 0 .353-.146l4.394-4.394a.5.5 0 0 0 .146-.353V4.893a.5.5 0 0 0-.146-.353L11.46.146zM8 4c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995A.905.905 0 0 1 8 4zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                </svg> </td>
                
                <td class="text-center pt-3 ps-1"> <h1> {{qnt_atrasos}} </h1></br>
                  <h6>Empréstimos Atrasados</h6></td> 
              </tr>
              
            </table>
          </a>
        </div>
      </div>
    </div>

    <br>
    <div class="row">
      <div class="col-md-7  card shadow-lg ms-5">
          <span class="d-flex justify-content-start">
            <small class="badge text-dark mt-2">Período:</small>
            <small class="badge text-dark mt-2" style="margin-left: 30%;">Dados:</small>
          </span>
          
          <span class="d-flex justify-content-start">
            
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" checked="" name="inlineRadioOptions" id="inlineRadio1" onclick= "renderiza_grafico('{% url "relatorio_emprestimos" %}')">
              <label class="form-check-label" for="inlineRadio1">Último Ano</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" onclick="filtra_grafico_semestre('{% url "relatorio_emprestimos" %}')">
              <label class="form-check-label" for="inlineRadio2">Último Semestre</label>
            </div>

            <select  style="margin-left: 8%;" onchange="updateChart(this)">
              <option value="0" selected>Empréstimos</option>
              <option value="1" >Usuários</option>

            </select>

           
          </span>
          
          <hr>
          
          <canvas id="grafico" width="250" height="200"></canvas>
            
      </div>

      <div class="col-md-4 card shadow-lg ms-2" style="max-width: 400px;">
        <div class="text-center mt-3" style="font-size: 20px;"><strong>Categorias de livros emprestados</strong></div>
        <canvas id="doughnut"  class="mx-auto d-block mt-3" style="max-width: 300px;max-height: 300px;"></canvas>
        <hr>

        <div class="text-center mt-2" style="font-size: 20px;"><strong>Livros com mais Emprestimos</strong></div>
        <table class="table table-striped table-hover ms-sm-auto col-lg-10 px-md-4 bg-light mt-3">
          <thead class="table-dark">
            <tr>
                <th scope="col">#</th>
                <th scope="col">Nome</th>
                <th scope="col" class="text-center">Empréstimos</th>
            </tr>
          </thead>

          {% if verifica == False %}
            <tbody>
              <tr class="table-active">
                <th scope="row"></th>
                <td class="text-center"><strong>Dados Insuficientes</strong> </td>
                <td class="text-center"></td>
              </tr>
            </tbody>
          {% endif %}
        
          {% for item in ranking %}
          <tbody>
            <tr>
                <th scope="row">{{forloop.counter}}</th>
                <td>{{ item.nome }}</td>
                <td class="text-center">{{ item.dcount }}</td>
            </tr>
          </tbody>
          {% endfor %}
        </table>
          

      </div>

</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js"></script>
<script src="{% static 'js/dashboard.js'%}"></script>

<script>

    window.onload = function(event){

      renderiza_grafico('{% url "relatorio_emprestimos" %}')
      renderiza_doughnut('{% url "relatorio_categorias" %}')
      myChart.hide(1);

    }

</script>




{% endblock %}